# Automated Zeek Script

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](https://github.com/yourname/zeek-automate/blob/main/LICENSE)

This script automates common Zeek processes, making it easier to analyze network traffic for potential security issues.

## Usage

To use the script, simply run it with the PCAP file as a command line argument:

```
python zeek-automate.py my-pcap-file.pcap
```

By default, the script will output the results to a directory called `zeek-output` in the current working directory. You can specify a different output directory using the `-o` or `--output` option:

```
python zeek-automate.py my-pcap-file.pcap -o my-zeek-output
```

The script will also generate a HTML report of the results if you use the `-r` or `--report` option:

```
python zeek-automate.py my-pcap-file.pcap -r
```

You can specify a custom Zeek policy file using the `-p` or `--policy` option:

```
python zeek-automate.py my-pcap-file.pcap -p my-zeek-policy.zeek
```

Finally, you can specify a custom name for the Zeek log file using the `-n` or `--name` option:

```
python zeek-automate.py my-pcap-file.pcap -n my-zeek.log
```

## Output

The script will output the results to the directory specified by the `-o` or `--output` option. By default, this directory is called `zeek-output` in the current working directory.

The script will generate one or more log files depending on the Zeek policy used. These log files will be stored in the output directory. If you specified a custom name for the log file using the `-n` or `--name` option, the log file will have that name instead of the default `zeek.log`.

If you used the `-r` or `--report` option, the script will also generate a HTML report of the results. This report will be stored in the output directory.

## Analysis

After running the script, you can analyze the results by examining the log files generated by Zeek. These log files contain detailed information about the network traffic that was analyzed, including things like connections, HTTP requests, and DNS requests.

You can use tools like `zeek-cut` or `zeek-awk` to extract specific information from the log files. For example, to extract all of the HTTP requests from the log files, you could use the following command:

```
zeek-cut -d -F '%Y-%m-%d-%H-%M-%S' -f http request_uri host < zeek-output/logs/zeek.log http.log > http-requests.txt
```

This command will extract the request URI and host information for each HTTP request and save it to a text file called `http-requests.txt`.

You can also use tools like `zeek-plot` to visualize the results. For example, to generate a bar chart of the top 10 most common HTTP user agents, you could use the following command:

```
zeek-cut -d -F '%Y-%m-%d-%H-%M-%S' -f http user_agent < zeek-output/logs/zeek.log http.log | zeek-plot -s count -c 10 -x 'HTTP User Agents' -y 'Count' -t 'Top 10 HTTP User Agents' -T svg
